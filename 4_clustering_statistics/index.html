
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/riskportal/risk/4_clustering_statistics/">
      
      
        <link rel="prev" href="../3_annotation_input/">
      
      
        <link rel="next" href="../5_analyzing_results/">
      
      
      <link rel="icon" href="../images/risk_logo.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>4. Clustering & Statistics - RISK Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#clustering-algorithms-and-statistical-methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="RISK Documentation" class="md-header__button md-logo" aria-label="RISK Documentation" data-md-component="logo">
      
  <img src="../images/risk_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RISK Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              4. Clustering & Statistics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/riskportal/risk-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    risk-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="RISK Documentation" class="md-nav__button md-logo" aria-label="RISK Documentation" data-md-component="logo">
      
  <img src="../images/risk_logo.png" alt="logo">

    </a>
    RISK Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/riskportal/risk-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    risk-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0. Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Installation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Core Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_network_input/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Network Input
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_annotation_input/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Annotation Input
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    4. Clustering & Statistics
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    4. Clustering & Statistics
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary-of-clustering-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Clustering Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary of Clustering Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#choosing-an-algorithm-quick-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Choosing an algorithm: quick guidance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-statistical-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Statistical Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary of Statistical Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#choosing-a-test-quick-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Choosing a test: quick guidance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shared-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Shared Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permutation-test" class="md-nav__link">
    <span class="md-ellipsis">
      Permutation Test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hypergeometric-test" class="md-nav__link">
    <span class="md-ellipsis">
      Hypergeometric Test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chi-squared-test" class="md-nav__link">
    <span class="md-ellipsis">
      Chi-squared Test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binomial-test" class="md-nav__link">
    <span class="md-ellipsis">
      Binomial Test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-step" class="md-nav__link">
    <span class="md-ellipsis">
      Next Step
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5_analyzing_results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Analyzing Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6_visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Visualization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7_parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Analysis Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Full Tutorial (HTML)
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial.zip" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download Tutorial Notebook & Data
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://mybinder.org/v2/gh/riskportal/risk-docs/HEAD?filepath=notebooks/quickstart.ipynb" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactive Quickstart (Binder)
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="clustering-algorithms-and-statistical-methods">Clustering Algorithms and Statistical Methods<a class="headerlink" href="#clustering-algorithms-and-statistical-methods" title="Permanent link">&para;</a></h1>
<p>Clustering algorithms detect structured regions of varying size and compactness, while statistical methods evaluate overrepresentation of biological terms within these regions. The choice of algorithm or test depends on network scale, density, and biological context, influencing the resolution, granularity, and rigor of the resulting modules and overrepresentation results.</p>
<hr />
<h2 id="summary-of-clustering-algorithms">Summary of Clustering Algorithms<a class="headerlink" href="#summary-of-clustering-algorithms" title="Permanent link">&para;</a></h2>
<p>Before applying statistical tests, RISK groups nodes into modules using community detection. Each algorithm has strengths for different network sizes and contexts.</p>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Speed</th>
<th>Primary use</th>
<th>When/Why (assumptions &amp; notes)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Louvain</td>
<td>Fast</td>
<td>Default, scalable to very large networks</td>
<td>Greedy modularity optimization (Blondel et al., 2008); efficient for &gt;10⁴ nodes; may produce disconnected subclusters.</td>
</tr>
<tr>
<td>Leiden</td>
<td>Fast</td>
<td>Improved Louvain with better resolution</td>
<td>Guarantees well-connected communities; more stable than Louvain (Traag et al., 2019); slightly higher runtime.</td>
</tr>
<tr>
<td>Markov Clustering</td>
<td>Medium</td>
<td>Detect smaller, compact complexes</td>
<td>Flow-based algorithm (Van Dongen, 2008); good for protein complexes or tightly connected submodules.</td>
</tr>
<tr>
<td>Walktrap</td>
<td>Medium</td>
<td>Hierarchical detection in mid-sized graphs</td>
<td>Random-walk based (Pons &amp; Latapy, 2005); effective for local structure; slower on &gt;10⁴ nodes.</td>
</tr>
<tr>
<td>Greedy Modularity</td>
<td>Fast</td>
<td>Coarse partitioning</td>
<td>Optimizes modularity via agglomeration; very fast but suffers from resolution limit (Newman, 2004).</td>
</tr>
<tr>
<td>Label Propagation</td>
<td>Fast</td>
<td>Quick heuristic</td>
<td>Unsupervised label spreading; no objective function; non-deterministic and unstable (Raghavan et al., 2007).</td>
</tr>
<tr>
<td>Spinglass</td>
<td>Slow</td>
<td>Small networks; theoretical interest</td>
<td>Statistical mechanics approach (Reichardt &amp; Bornholdt, 2006); finds communities by simulating spin states; computationally intensive.</td>
</tr>
</tbody>
</table>
<h3 id="choosing-an-algorithm-quick-guidance">Choosing an algorithm: quick guidance<a class="headerlink" href="#choosing-an-algorithm-quick-guidance" title="Permanent link">&para;</a></h3>
<ul>
<li>For large networks (&gt;10⁴ nodes): <strong>Louvain</strong> or <strong>Leiden</strong> (fast, scalable).</li>
<li>For small, compact complexes: <strong>Markov Clustering</strong> (protein complexes, submodules).</li>
<li>For hierarchical/local structure: <strong>Walktrap</strong> (medium size).</li>
<li>For exploratory speed: <strong>Greedy</strong> or <strong>Label Propagation</strong> (but less precise).</li>
<li>For research/theory on small graphs: <strong>Spinglass</strong> (rarely used in practice).</li>
</ul>
<hr />
<h2 id="summary-of-statistical-methods">Summary of Statistical Methods<a class="headerlink" href="#summary-of-statistical-methods" title="Permanent link">&para;</a></h2>
<p>RISK implements a suite of statistical tests—ranging from fast approximations to rigorous overrepresentation analysis—to assess functional term overrepresentation in network neighborhoods. Each method has strengths depending on dataset size, structure, and precision requirements.</p>
<table>
<thead>
<tr>
<th>Test</th>
<th>Speed</th>
<th>Primary use</th>
<th>When/Why (assumptions &amp; notes)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Permutation</td>
<td>Medium</td>
<td>Most rigorous; non-parametric</td>
<td>Distribution-free empirical null (permute network or labels); preferred when assumptions are unclear; computationally intensive.</td>
</tr>
<tr>
<td>Hypergeometric</td>
<td>Medium</td>
<td>Standard for GO/pathway overrepresentation</td>
<td>Exact test for finite populations sampled without replacement; widely used for term–to–gene membership tables.</td>
</tr>
<tr>
<td>Chi-squared</td>
<td>Fast</td>
<td>Approximate contingency-table testing</td>
<td>Suitable for large samples with expected counts ≥ 5 per cell; fast but approximate; avoid with sparse/low counts.</td>
</tr>
<tr>
<td>Binomial</td>
<td>Fast</td>
<td>Scalable approximation</td>
<td>Fast approximation assuming independent trials/with-replacement; useful for large populations with small samples.</td>
</tr>
</tbody>
</table>
<h3 id="choosing-a-test-quick-guidance">Choosing a test: quick guidance<a class="headerlink" href="#choosing-a-test-quick-guidance" title="Permanent link">&para;</a></h3>
<ul>
<li>For rigorous overrepresentation analysis with minimal assumptions: use <strong>Permutation</strong> or <strong>Hypergeometric</strong>.</li>
<li>For large samples with many categories and sufficient counts: <strong>Chi-squared</strong> offers a fast approximate test.</li>
<li>For speed and scalability with large populations and small samples: use <strong>Binomial</strong> as a practical approximation.</li>
</ul>
<h2 id="shared-parameters">Shared Parameters<a class="headerlink" href="#shared-parameters" title="Permanent link">&para;</a></h2>
<p>Shared parameters among statistical methods.</p>
<ul>
<li><code>network</code> (nx.Graph): The network graph.</li>
<li><code>annotation</code> (dict): The annotation associated with the network.</li>
<li><code>distance_metric</code> (str, list, tuple, or np.ndarray, optional): Method(s) used to compute distances for community detection. You can specify a single method or a list/tuple/array of methods to apply multiple community detection algorithms. Options include:<ul>
<li><code>'louvain'</code>: Applies the Louvain method for community detection. <em>(default)</em></li>
<li><code>'greedy_modularity'</code>: Detects communities in a graph based on the greedy optimization of modularity.</li>
<li><code>'label_propagation'</code>: Uses label propagation to find communities.</li>
<li><code>'leiden'</code>: Applies the Leiden method for community detection.</li>
<li><code>'markov_clustering'</code>: Implements the Markov Clustering Algorithm.</li>
<li><code>'walktrap'</code>: Detects communities via random walks.</li>
<li><code>'spinglass'</code>: Community detection based on the spinglass model.</li>
</ul>
</li>
<li><code>louvain_resolution</code> (float, optional): Resolution parameter for the Louvain method. Only applies if <code>'louvain'</code> is one of the distance metrics. Defaults to 0.1.</li>
<li><code>leiden_resolution</code> (float, optional): Resolution parameter for the Leiden method. Only applies if <code>'leiden'</code> is one of the distance metrics. Defaults to 1.0.</li>
<li><code>fraction_shortest_edges</code> (float, list, tuple, or np.ndarray, optional): Shortest edge rank fraction threshold(s) for creating subgraphs. Can be a single float for one threshold or a list/tuple of floats corresponding to multiple thresholds. Defaults to 0.5.</li>
<li><code>null_distribution</code> (str, optional): Defines the type of null distribution to use for comparison. Options include:<ul>
<li><code>'network'</code>: Randomly permuted network structure. <em>(default)</em></li>
<li><code>'annotation'</code>: Randomly permuted annotations.</li>
</ul>
</li>
<li><code>random_seed</code> (int, optional): Seed for random number generation in permutation test. Defaults to 888.</li>
</ul>
<hr />
<h2 id="permutation-test">Permutation Test<a class="headerlink" href="#permutation-test" title="Permanent link">&para;</a></h2>
<p>Builds an empirical null by permuting either the network structure or annotation labels.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>Non-parametric and distribution-free; ideal when analytical assumptions (independence, variance, distribution) are doubtful.</li>
<li>Supports flexible nulls (permute network topology or term labels) to match study design.</li>
<li>Most rigorous option but computationally intensive; prefer for smaller networks or final confirmation analyses.</li>
</ul>
<p><strong>Additional Parameters:</strong></p>
<ul>
<li><code>score_metric</code> (str, optional): Metric used to score neighborhoods. Options include: - <code>'sum'</code>: Sums the annotation values within each neighborhood. <em>(default)</em> - <code>'stdev'</code>: Computes the standard deviation of annotation values within each neighborhood.</li>
<li><code>num_permutations</code> (int, optional): Number of permutations for significance testing. Defaults to 1000.</li>
<li><code>max_workers</code> (int, optional): Maximum number of workers for parallel computation. Defaults to 1.</li>
</ul>
<p><strong>Returns:</strong>
<code>dict</code>: A dictionary containing the computed significance of neighborhoods within the network.</p>
<div class="highlight"><pre><span></span><code><span class="n">neighborhoods</span> <span class="o">=</span> <span class="n">risk</span><span class="o">.</span><span class="n">load_neighborhoods_permutation</span><span class="p">(</span>
    <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
    <span class="n">annotation</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>
    <span class="n">distance_metric</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span>
    <span class="n">louvain_resolution</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">fraction_shortest_edges</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">score_metric</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span>
    <span class="n">null_distribution</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span>
    <span class="n">num_permutations</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">888</span><span class="p">,</span>
    <span class="n">max_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="hypergeometric-test">Hypergeometric Test<a class="headerlink" href="#hypergeometric-test" title="Permanent link">&para;</a></h2>
<p>Exact test based on finite sampling without replacement.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>Standard for GO/pathway overrepresentation with term–to–gene membership tables.</li>
<li>Appropriate for finite populations sampled without replacement (e.g., selected cluster vs whole network).</li>
<li>Exact test; more accurate than approximations when sample is not negligible relative to the population.</li>
</ul>
<p><strong>Returns:</strong>
<code>dict</code>: A dictionary containing the computed significance of neighborhoods within the network.</p>
<div class="highlight"><pre><span></span><code><span class="n">neighborhoods</span> <span class="o">=</span> <span class="n">risk</span><span class="o">.</span><span class="n">load_neighborhoods_hypergeom</span><span class="p">(</span>
    <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
    <span class="n">annotation</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>
    <span class="n">distance_metric</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span>
    <span class="n">louvain_resolution</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">fraction_shortest_edges</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">null_distribution</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">888</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="chi-squared-test">Chi-squared Test<a class="headerlink" href="#chi-squared-test" title="Permanent link">&para;</a></h2>
<p>Evaluates significance using contingency tables.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>Suitable for large-sample contingency analyses across multiple categories.</li>
<li>Rule of thumb: expected counts per cell should be ≥ 5; avoid with sparse tables.</li>
<li>Fast and scalable but approximate; consider permutation or exact tests for sparse data.</li>
</ul>
<p><strong>Returns:</strong>
<code>dict</code>: A dictionary containing the computed significance of neighborhoods within the network.</p>
<div class="highlight"><pre><span></span><code><span class="n">neighborhoods</span> <span class="o">=</span> <span class="n">risk</span><span class="o">.</span><span class="n">load_neighborhoods_chi2</span><span class="p">(</span>
    <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
    <span class="n">annotation</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>
    <span class="n">distance_metric</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span>
    <span class="n">louvain_resolution</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">fraction_shortest_edges</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">null_distribution</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">888</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="binomial-test">Binomial Test<a class="headerlink" href="#binomial-test" title="Permanent link">&para;</a></h2>
<p>Fast approximation to overrepresentation based on independent trials.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>Provides a scalable approximation to the hypergeometric test, assuming independent trials or sampling with replacement.</li>
<li>Useful for very large populations with small samples where exact tests are computationally costly.</li>
<li>Offers speed and scalability while being less precise than exact methods.</li>
</ul>
<p><strong>Returns:</strong>
<code>dict</code>: A dictionary containing the computed significance of neighborhoods within the network.</p>
<div class="highlight"><pre><span></span><code><span class="n">neighborhoods</span> <span class="o">=</span> <span class="n">risk</span><span class="o">.</span><span class="n">load_neighborhoods_binom</span><span class="p">(</span>
    <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
    <span class="n">annotation</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>
    <span class="n">distance_metric</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span>
    <span class="n">louvain_resolution</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">fraction_shortest_edges</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">null_distribution</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">888</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="next-step">Next Step<a class="headerlink" href="#next-step" title="Permanent link">&para;</a></h2>
<p><a href="../5_analyzing_results/">Building and Analyzing Networks</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.expand", "content.code.copy", "toc.integrate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>